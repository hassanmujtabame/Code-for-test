<template>
    <div>
           <button @click="openChat" class="text-white  border-0 px-2 py-1 rounded-3  px-3 mb-3 "
           style="background: rgba(255, 188, 0, 1);"
           >
                    <svg width="24" height="24" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.4294 25.2883L16.0826 24.1844L14.528 23.2636L13.8736 24.3676L15.4294 25.2883ZM10.6016 24.1844L11.2548 25.2883L12.8094 24.3676L12.1574 23.2636L10.6016 24.1844ZM13.8736 24.3676C13.8172 24.4577 13.7389 24.5321 13.6459 24.5836C13.553 24.6351 13.4484 24.6622 13.3421 24.6622C13.2358 24.6622 13.1312 24.6351 13.0383 24.5836C12.9453 24.5321 12.867 24.4577 12.8106 24.3676L11.2548 25.2883C12.1864 26.8634 14.4966 26.8634 15.4294 25.2883L13.8748 24.3676H13.8736ZM11.5344 2.36632H15.1498V0.558594H11.5344V2.36632ZM24.4897 11.7062V12.9114H26.2975V11.7062H24.4897ZM2.19445 12.9114V11.7062H0.386719V12.9114H2.19445ZM0.386719 12.9114C0.386719 14.3033 0.386719 15.3916 0.446976 16.2701C0.507234 17.1559 0.631364 17.8935 0.914575 18.5756L2.58491 17.8838C2.40776 17.4596 2.30411 16.9414 2.24988 16.1472C2.19445 15.3446 2.19445 14.3274 2.19445 12.9114H0.386719ZM8.28408 21.0365C6.77041 21.01 5.97742 20.9136 5.35556 20.6557L4.66501 22.326C5.63515 22.7286 6.73907 22.8189 8.25274 22.8455L8.28408 21.0365ZM0.914575 18.5756C1.26282 19.4164 1.77327 20.1803 2.41677 20.8238C3.06027 21.4673 3.82423 21.9778 4.66501 22.326L5.35556 20.6557C4.10061 20.1359 3.10475 19.1388 2.58491 17.8838L0.914575 18.5756ZM24.4897 12.9114C24.4897 14.3274 24.4897 15.3446 24.4343 16.1472C24.3801 16.9414 24.2764 17.4596 24.1005 17.8838L25.7696 18.5756C26.0528 17.8935 26.177 17.1559 26.2384 16.2701C26.2987 15.3916 26.2975 14.3033 26.2975 12.9114H24.4897ZM18.4314 22.843C19.9451 22.8177 21.049 22.7286 22.0192 22.326L21.3274 20.6557C20.7068 20.9136 19.9138 21.01 18.4013 21.0365L18.4314 22.8442V22.843ZM24.1005 17.8838C23.5806 19.1388 22.5836 20.1359 21.3286 20.6557L22.0192 22.326C22.86 21.9778 23.6239 21.4673 24.2674 20.8238C24.9109 20.1803 25.4214 19.4164 25.7696 18.5756L24.1005 17.8838ZM15.1498 2.36632C17.1395 2.36632 18.5688 2.36632 19.6836 2.47358C20.7851 2.57843 21.4853 2.77848 22.0445 3.12075L22.9881 1.57936C22.0975 1.03463 21.0876 0.791188 19.8547 0.673084C18.6351 0.557389 17.1046 0.558594 15.1498 0.558594V2.36632ZM26.2975 11.7062C26.2975 9.75149 26.2975 8.22215 26.1818 7.00133C26.0649 5.76846 25.8214 4.75734 25.2767 3.86794L23.7341 4.81157C24.0776 5.37076 24.2776 6.07096 24.3825 7.17367C24.4885 8.28723 24.4897 9.71654 24.4897 11.7062H26.2975ZM22.0433 3.12075C22.7328 3.54291 23.3127 4.12231 23.7353 4.81157L25.2767 3.86794C24.7052 2.93513 23.9209 2.15088 22.9881 1.57936L22.0445 3.12195L22.0433 3.12075ZM11.5344 0.558594C9.57961 0.558594 8.05028 0.558594 6.82946 0.673084C5.59659 0.791188 4.58547 1.03463 3.69606 1.57936L4.6397 3.12195C5.19889 2.77848 5.89908 2.57843 7.00179 2.47358C8.11535 2.36753 9.54466 2.36632 11.5344 2.36632V0.558594ZM2.19445 11.7062C2.19445 9.71654 2.19445 8.28723 2.3017 7.17246C2.40655 6.07096 2.60661 5.37076 2.94887 4.81157L1.40748 3.86914C0.862753 4.75855 0.619313 5.76846 0.501208 7.00133C0.386719 8.22336 0.386719 9.75149 0.386719 11.7062H2.19445ZM3.69606 1.57936C2.76325 2.15088 1.979 2.93633 1.40748 3.86914L2.95008 4.81157C3.37204 4.12259 3.95102 3.54321 4.6397 3.12075L3.69606 1.57936ZM12.1562 23.2636C11.9128 22.8503 11.6983 22.4851 11.4886 22.1983C11.2729 21.8838 10.9927 21.6188 10.6667 21.421L9.75798 22.984C9.81462 23.0178 9.89295 23.078 10.0279 23.2636C10.1738 23.4637 10.3389 23.7409 10.6016 24.1844L12.1562 23.2636ZM8.25274 22.843C8.78301 22.8527 9.11684 22.8599 9.37233 22.8876C9.61095 22.9141 9.70374 22.9527 9.75798 22.984L10.6667 21.421C10.3292 21.234 9.95571 21.1214 9.57118 21.0908C9.21204 21.051 8.7806 21.045 8.28408 21.0365L8.25274 22.8455V22.843ZM16.0826 24.1844C16.3453 23.7421 16.5104 23.4637 16.6563 23.2636C16.7912 23.078 16.8696 23.0178 16.9262 22.984L16.0175 21.421C15.668 21.6258 15.415 21.897 15.1956 22.1983C14.9871 22.4851 14.7714 22.8491 14.5268 23.2636L16.0826 24.1844ZM18.4013 21.0365C17.9048 21.045 17.4721 21.051 17.113 21.0908C16.7382 21.1329 16.3706 21.2161 16.0175 21.421L16.9262 22.984C16.9804 22.9527 17.0732 22.9141 17.3119 22.8876C17.5674 22.8599 17.9024 22.8515 18.4327 22.843L18.4013 21.0353V21.0365Z" fill="#FFF2F2"/>
                    <g opacity="0.5">
                    <path d="M8.52148 9.89844H18.1627H8.52148ZM8.52148 14.1165H15.1498H8.52148Z" fill="#FFF2F2"/>
                    <path d="M8.52148 9.89844H18.1627M8.52148 14.1165H15.1498" stroke="white" stroke-width="1.5" stroke-linecap="round"/>
                    </g>
                    </svg>
                        تواصل</button>
        <div class="position-relative">
        <d-user-info :member="{
            job:userPage.job_title,
            name:userPage.name,
            image:userPage.image,
            bio:userPage.description
        }"
         :showBtnChat="false"
         />
         <p class="rating">
                           
                           <span style="color: #FFBC00 ; " class="fw-bold">
                              {{rate_states.rate}}
                           </span>
                           <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                               <path d="M9.4802 20.69C8.9802 20.69 8.6302 20.52 8.4202 20.36C8.0202 20.07 7.40019 19.32 7.79019 17.64L8.36017 15.18C8.41017 14.97 8.30018 14.59 8.15018 14.43L6.16019 12.44C5.11019 11.39 5.20018 10.48 5.34018 10.03C5.48018 9.58 5.94018 8.78999 7.40018 8.53999L9.9502 8.12C10.1402 8.08999 10.4502 7.86 10.5302 7.69L11.9402 4.87C12.6202 3.51 13.5202 3.31 14.0002 3.31C14.4802 3.31 15.3802 3.51 16.0602 4.87L17.4702 7.69C17.5602 7.86 17.8602 8.08999 18.0502 8.12L20.6002 8.53999C22.0602 8.77999 22.5202 9.58 22.6602 10.03C22.8002 10.48 22.8902 11.39 21.8402 12.44L19.8502 14.43C19.7002 14.58 19.5902 14.97 19.6402 15.18L20.2102 17.64C20.6002 19.33 19.9802 20.07 19.5802 20.36C19.1802 20.65 18.2902 21.02 16.7902 20.13L14.4002 18.71C14.2002 18.59 13.7802 18.59 13.5802 18.71L11.1902 20.13C10.5002 20.55 9.9202 20.69 9.4802 20.69ZM14.0002 4.81C13.8402 4.81 13.5502 4.99999 13.2802 5.53999L11.8702 8.36C11.5702 8.97 10.8602 9.49001 10.1902 9.60001L7.6402 10.02C7.0702 10.12 6.8102 10.33 6.7602 10.49C6.7102 10.65 6.80018 10.97 7.21018 11.38L9.2002 13.37C9.7102 13.88 9.98019 14.81 9.82019 15.51L9.25019 17.97C9.08019 18.68 9.19017 19.06 9.30017 19.15C9.41017 19.23 9.81018 19.22 10.4302 18.84L12.8302 17.42C13.5002 17.02 14.5102 17.02 15.1702 17.42L17.5602 18.84C18.1902 19.21 18.5902 19.23 18.7002 19.15C18.8102 19.07 18.9202 18.69 18.7502 17.97L18.1802 15.51C18.0202 14.8 18.2802 13.88 18.8002 13.37L20.7902 11.38C21.2002 10.97 21.2902 10.64 21.2402 10.49C21.1902 10.34 20.9302 10.12 20.3602 10.02L17.8102 9.60001C17.1402 9.49001 16.4302 8.97 16.1302 8.36L14.7202 5.53999C14.4502 4.99999 14.1602 4.81 14.0002 4.81Z" fill="#FFBC00"/>
                               <path d="M8 5.75H2C1.59 5.75 1.25 5.41 1.25 5C1.25 4.59 1.59 4.25 2 4.25H8C8.41 4.25 8.75 4.59 8.75 5C8.75 5.41 8.41 5.75 8 5.75Z" fill="#FFBC00"/>
                               <path d="M5 19.75H2C1.59 19.75 1.25 19.41 1.25 19C1.25 18.59 1.59 18.25 2 18.25H5C5.41 18.25 5.75 18.59 5.75 19C5.75 19.41 5.41 19.75 5 19.75Z" fill="#FFBC00"/>
                               <path d="M3 12.75H2C1.59 12.75 1.25 12.41 1.25 12C1.25 11.59 1.59 11.25 2 11.25H3C3.41 11.25 3.75 11.59 3.75 12C3.75 12.41 3.41 12.75 3 12.75Z" fill="#FFBC00"/>
                               </svg>
                               
                       </p>
                    </div>
  <div v-if="false" class="box info border p-3">
                        <div class="main-img text-center m-auto">
                            <img class="rounded-circle img-person" :src="userPage.image" :alt="userPage.name" width="140" height="140">
                        </div>
                        <div class=" text-center">
                            <h5 class="m-c mt-2">
                             {{userPage.name}}
                            </h5>
                            <p>
                                {{userPage.job_title}}
                            </p>
                            <p class="t-c">
                                {{userPage.description??userPage.job??userPage.job_title}}
                               </p>
                               <div class="message-service">
                    <button class="text-white border-0 p-2 px-3"
                       @click="sendMessage" >
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M17 21.25H7C3.35 21.25 1.25 19.15 1.25 15.5V8.5C1.25 4.85 3.35 2.75 7 2.75H17C20.65 2.75 22.75 4.85 22.75 8.5V15.5C22.75 19.15 20.65 21.25 17 21.25ZM7 4.25C4.14 4.25 2.75 5.64 2.75 8.5V15.5C2.75 18.36 4.14 19.75 7 19.75H17C19.86 19.75 21.25 18.36 21.25 15.5V8.5C21.25 5.64 19.86 4.25 17 4.25H7Z"
                                fill="white" />
                            <path
                                d="M11.9998 12.87C11.1598 12.87 10.3098 12.61 9.65978 12.08L6.52978 9.57997C6.20978 9.31997 6.14978 8.84997 6.40978 8.52997C6.66978 8.20997 7.13978 8.14997 7.45978 8.40997L10.5898 10.91C11.3498 11.52 12.6398 11.52 13.3998 10.91L16.5298 8.40997C16.8498 8.14997 17.3298 8.19997 17.5798 8.52997C17.8398 8.84997 17.7898 9.32997 17.4598 9.57997L14.3298 12.08C13.6898 12.61 12.8398 12.87 11.9998 12.87Z"
                                fill="white" />
                        </svg>
                        {{ $t('message') }}
                    </button>
                </div>
                        </div>
                        <p class="rating">
                           
                            <span style="color: #FFBC00 ; " class="fw-bold">
                               {{rate_states.rate}}
                            </span>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9.4802 20.69C8.9802 20.69 8.6302 20.52 8.4202 20.36C8.0202 20.07 7.40019 19.32 7.79019 17.64L8.36017 15.18C8.41017 14.97 8.30018 14.59 8.15018 14.43L6.16019 12.44C5.11019 11.39 5.20018 10.48 5.34018 10.03C5.48018 9.58 5.94018 8.78999 7.40018 8.53999L9.9502 8.12C10.1402 8.08999 10.4502 7.86 10.5302 7.69L11.9402 4.87C12.6202 3.51 13.5202 3.31 14.0002 3.31C14.4802 3.31 15.3802 3.51 16.0602 4.87L17.4702 7.69C17.5602 7.86 17.8602 8.08999 18.0502 8.12L20.6002 8.53999C22.0602 8.77999 22.5202 9.58 22.6602 10.03C22.8002 10.48 22.8902 11.39 21.8402 12.44L19.8502 14.43C19.7002 14.58 19.5902 14.97 19.6402 15.18L20.2102 17.64C20.6002 19.33 19.9802 20.07 19.5802 20.36C19.1802 20.65 18.2902 21.02 16.7902 20.13L14.4002 18.71C14.2002 18.59 13.7802 18.59 13.5802 18.71L11.1902 20.13C10.5002 20.55 9.9202 20.69 9.4802 20.69ZM14.0002 4.81C13.8402 4.81 13.5502 4.99999 13.2802 5.53999L11.8702 8.36C11.5702 8.97 10.8602 9.49001 10.1902 9.60001L7.6402 10.02C7.0702 10.12 6.8102 10.33 6.7602 10.49C6.7102 10.65 6.80018 10.97 7.21018 11.38L9.2002 13.37C9.7102 13.88 9.98019 14.81 9.82019 15.51L9.25019 17.97C9.08019 18.68 9.19017 19.06 9.30017 19.15C9.41017 19.23 9.81018 19.22 10.4302 18.84L12.8302 17.42C13.5002 17.02 14.5102 17.02 15.1702 17.42L17.5602 18.84C18.1902 19.21 18.5902 19.23 18.7002 19.15C18.8102 19.07 18.9202 18.69 18.7502 17.97L18.1802 15.51C18.0202 14.8 18.2802 13.88 18.8002 13.37L20.7902 11.38C21.2002 10.97 21.2902 10.64 21.2402 10.49C21.1902 10.34 20.9302 10.12 20.3602 10.02L17.8102 9.60001C17.1402 9.49001 16.4302 8.97 16.1302 8.36L14.7202 5.53999C14.4502 4.99999 14.1602 4.81 14.0002 4.81Z" fill="#FFBC00"/>
                                <path d="M8 5.75H2C1.59 5.75 1.25 5.41 1.25 5C1.25 4.59 1.59 4.25 2 4.25H8C8.41 4.25 8.75 4.59 8.75 5C8.75 5.41 8.41 5.75 8 5.75Z" fill="#FFBC00"/>
                                <path d="M5 19.75H2C1.59 19.75 1.25 19.41 1.25 19C1.25 18.59 1.59 18.25 2 18.25H5C5.41 18.25 5.75 18.59 5.75 19C5.75 19.41 5.41 19.75 5 19.75Z" fill="#FFBC00"/>
                                <path d="M3 12.75H2C1.59 12.75 1.25 12.41 1.25 12C1.25 11.59 1.59 11.25 2 11.25H3C3.41 11.25 3.75 11.59 3.75 12C3.75 12.41 3.41 12.75 3 12.75Z" fill="#FFBC00"/>
                                </svg>
                                
                        </p>
                    </div>
                    <div class="box border  mt-3">
                        <div>
                            <h3 class=" border-bottom p-2">
                              تقيم الخدمه 
                            </h3>
                        </div>
                        <div  v-if="items && items.length>0" >

                        <div  v-for="(item,i) in items" :key="i" class="box border-bottom">

                            <div class="d-flex align-items-center justify-content-between  m-0 p-2">
                                    <div class="d-flex align-items-center ">
                                        <div>
                                            <img class="rounded-circle" :src="item.image" :alt="item.from_user" width="48 " height="48">
                                        </div>
                                        <p class="m-c fw-bold px-1 fs-6 p-0 m-0">
                                           {{item.from_user}}
                                        </p>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <d-rate-stars :size="16" :value="item.rate"/>
    
                                    </div>
    
                            </div>
                            <div>
                                <p class="t-c px-2">
                                    {{ item.comment }}
                                </p>
                            </div>
                        </div>
                        </div>
                               <div v-else class="d-flex align-items-center justify-content-center">
                <h6 class="t-c">لا توجد تقييمات</h6>
            </div>
                    </div>
        <AddMessage  />        
               
                </div>
</template>

<script>
import readyServiceAPI from '@/services/api/service-provider/provider/ready-service.js'
import AddMessage from './service-provider-message.vue'
export default {
 name:'section-user',
 props:['userPage'],
      components:{
    AddMessage
},
 data:()=>({
    loading:true,
    items:[],
    rate_states :{
        count_ready_service:0,
        provider_message_count: 0,
        rate: 0,
        count_rate:0,
        service_finished: 0,
        service_underway: 0,
        service_waiting: 0
    }

 }),
 methods:{
    
    sendMessage(){
   
        if(!this.userPage.id) return;
        this.showSendMsgProvider(this.userPage)
    },
    async rateStatics(){
        this.loading =  true;
        try {
            let params={
                user_id:this.userPage.id
            }
           let { data } = await   readyServiceAPI.getRateReadyServicesStatistics(params) 
           if(data.success){
            this.rate_states =  data.data
           }
        } catch (error) {
            console.log('error',error)
        }
        this.loading =  false;
    },
    async initializing() {
            try {
                let params={
                user_id:this.$route.params.id
            }
                let {data} = await readyServiceAPI.getListRates(params)
                if(data.success){
                    this.items = data.data.filter((x,i)=>i<4);
                }
            } catch (error) {
                console.log('error', error)
                console.log('response', error.response)
            }
        },
            openChat(){
    this.fireOpenDialog('send-message',this.member)
    }
 },
 mounted(){
    this.rateStatics()
    this.initializing()
 }
}
</script>

<style scoped>
.img-person{
    min-height:140px;
    min-width:140px;
}
.rating{
    position: absolute;
    top: 12px;
    left: 12px;
    right:auto;
}
</style>